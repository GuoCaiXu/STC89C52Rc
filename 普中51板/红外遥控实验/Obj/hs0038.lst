C51 COMPILER V9.60.0.0   HS0038                                                            11/09/2022 14:51:48 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE HS0038
OBJECT MODULE PLACED IN .\Obj\hs0038.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE App\hs0038\hs0038.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\Public;.\App\hs003
                    -8;.\App\smg) DEBUG OBJECTEXTEND PRINT(.\Obj\hs0038.lst) TABS(2) OBJECT(.\Obj\hs0038.obj)

line level    source

   1          # include "hs0038.h"
   2          
   3          u8 gired[4];
   4          
   5          //çº¢å¤–é¥æ§åˆå§‹åŒ–
   6          void hs0038_ired_init(){
   7   1      
   8   1          //å¤–éƒ¨ä¸­æ–­0 ä¸­æ–­å¼€å¯
   9   1          IT0 = 1;
  10   1      
  11   1          //å¼€å¯å¤–éƒ¨ä¸­æ–­0
  12   1          EX0 = 1;
  13   1      
  14   1          //IRED æ‹‰é«˜ç”µå¹³ åˆå§‹åŒ–ç«¯å£
  15   1          IRED = 1;
  16   1      }
  17          
  18          //iredåˆå§‹åŒ–å‡½æ•°
  19          void ired() interrupt 0{
  20   1          u16 time_cnt = 0;
  21   1          u8 i = 0, j = 0;
  22   1          u8 ired_high_time = 0;
  23   1      
  24   1          if (IRED == 0){
  25   2              //10ms é™åˆ¶æ¡ä»¶
  26   2              time_cnt = 1000;
  27   2      
  28   2              while((!IRED) && (time_cnt)){
  29   3                  //å»¶æ—¶10 us
  30   3                  delay_us(1);
  31   3                  time_cnt --;
  32   3                  if (time_cnt == 0) return;
  33   3                  //cnt å‡ä¸€æ¬¡å»¶è¿Ÿ10us å½“cnt = 0 æ—¶ï¼Œ ä¹Ÿå°±æ˜¯10ms è¶…è¿‡9ms ä½ç”µå¹³ è®¤ä¸ºæ˜¯ä¸€ä¸ªé
             -”™è¯¯ä¿¡å·
  34   3              }
  35   2      
  36   2              //åˆ¤æ–­ ired æ‹‰é«˜ç”µå¹³4.5ms
  37   2              if (IRED){
  38   3                  time_cnt = 500;
  39   3                  while(IRED && time_cnt){
  40   4                      delay_us(1);
  41   4                      time_cnt --;
  42   4                      if (time_cnt == 0) return;
  43   4                  }
  44   3      
  45   3                  //å¼€å§‹è¯»å–æ•°æ®
  46   3                  for (i = 0; i < 4; i++){
  47   4                      for (j = 0; j < 8; j++){
  48   5      
  49   5                          //å…ˆæ‹‰ä½0.56ms ä½ç”µå¹³
  50   5                          time_cnt =60;
  51   5                          while((!IRED) && time_cnt){
  52   6      
  53   6                              //å‡ä¸€æ¬¡è€—æ—¶10 us
C51 COMPILER V9.60.0.0   HS0038                                                            11/09/2022 14:51:48 PAGE 2   

  54   6                              delay_us(1);
  55   6                              time_cnt--;
  56   6                              if (time_cnt == 0) return;
  57   6                          }
  58   5      
  59   5                          time_cnt = 20;
  60   5                          while(IRED){
  61   6                              //ä¸€æ¬¡å»¶è¿Ÿ100 us
  62   6                              delay_us(10);
  63   6                              ired_high_time++;
  64   6                              if (ired_high_time >= 20) return;
  65   6                          }
  66   5                          gired[i] >>= 1;
  67   5                          if (ired_high_time >= 8)
  68   5                          gired[i] |= 0x80;
  69   5                      }
  70   4                  }
  71   3              }
  72   2              if (gired[2] != ~gired[3]){
  73   3                  for (i = 0; i < 4; i++)
  74   3                  gired[i] = 0;
  75   3                  return;
  76   3              }
  77   2          }
  78   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    331    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
